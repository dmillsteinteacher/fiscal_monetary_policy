<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fiscal & Monetary Policy Simulator</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configure Tailwind for the "Inter" font -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        /* Custom styles for the graph container and canvas */
        .graph-container {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 1rem;
        }
        canvas {
            border: 1px solid #ccc;
            border-radius: 8px;
            background-color: #ffffff;
            /* Make canvas resize fluidly within its container */
            max-width: 100%;
            height: auto; 
        }
        /* Style the input range for better visibility */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            height: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            outline: none;
            opacity: 0.7;
            transition: opacity .2s;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4f46e5;
            cursor: pointer;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        }
        input[type=range]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4f46e5;
            cursor: pointer;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body class="bg-gray-50 font-sans p-4 md:p-8">

    <div class="max-w-6xl mx-auto">
        <header class="text-center mb-10 p-6 bg-white shadow-lg rounded-xl">
            <h1 class="text-3xl font-extrabold text-indigo-700 md:text-4xl">Macro Policy Combination Simulator</h1>
            <p class="text-gray-600 mt-2">Model Fiscal & Monetary Policy shifts on the MLF and AS-AD graphs.</p>
        </header>

        <!-- Policy Sliders Section -->
        <section class="mb-12 p-6 bg-white shadow-lg rounded-xl">
            <h2 class="text-2xl font-semibold mb-6 text-indigo-600 border-b pb-2">Policy Controls</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Fiscal Policy Slider -->
                <div>
                    <label for="fiscalPolicy" class="block text-lg font-medium text-gray-700 mb-2">
                        Fiscal Policy (<span id="fiscalValueText" class="font-bold text-red-500">Neutral</span>)
                    </label>
                    <input type="range" id="fiscalPolicy" min="-10" max="10" value="0" step="1"
                        oninput="updatePolicy('fiscal', this.value)">
                    <div class="flex justify-between text-sm text-gray-500 mt-1">
                        <span>Contractionary (CFP)</span>
                        <span>Neutral (0)</span>
                        <span>Expansionary (XFP)</span>
                    </div>
                </div>

                <!-- Monetary Policy Slider -->
                <div>
                    <label for="monetaryPolicy" class="block text-lg font-medium text-gray-700 mb-2">
                        Monetary Policy (<span id="monetaryValueText" class="font-bold text-red-500">Neutral</span>)
                    </label>
                    <input type="range" id="monetaryPolicy" min="-10" max="10" value="0" step="1"
                        oninput="updatePolicy('monetary', this.value)">
                    <div class="flex justify-between text-sm text-gray-500 mt-1">
                        <span>Contractionary (CMP)</span>
                        <span>Neutral (0)</span>
                        <span>Expansionary (XMP)</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Graph Section -->
        <section class="mb-12 p-6 bg-white shadow-lg rounded-xl">
            <h2 class="text-2xl font-semibold mb-6 text-indigo-600 border-b pb-2">Policy Graphs</h2>
            <div class="graph-container">
                <div class="w-full lg:w-5/12 p-4 border rounded-lg shadow-inner bg-gray-50">
                    <h3 class="text-xl font-medium text-center mb-3">Loanable Funds Market (MLF)</h3>
                    <canvas id="mlfCanvas" width="450" height="400"
                        class="mx-auto block"></canvas>
                </div>
                <div class="w-full lg:w-5/12 p-4 border rounded-lg shadow-inner bg-gray-50">
                    <h3 class="text-xl font-medium text-center mb-3">Aggregate Supply - Aggregate Demand (AS-AD)</h3>
                    <canvas id="asadCanvas" width="450" height="400"
                        class="mx-auto block"></canvas>
                </div>
            </div>
        </section>

        <!-- Analysis Section (Now Static) -->
        <section class="p-6 bg-white shadow-lg rounded-xl">
            <h2 class="text-2xl font-semibold mb-6 text-indigo-600 border-b pb-2">Policy Analysis & Commentary</h2>
            <div id="analysisContent" class="space-y-6 text-gray-700">
                
                <h3 class="text-xl font-semibold text-indigo-700 mb-4 border-b pb-1">Standalone Policy Flaws</h3>

                <!-- XFP Flaw: Crowding Out -->
                <div class="p-4 border border-red-300 rounded-lg bg-red-50">
                    <h4 class="font-bold text-red-700 mb-1">Expansionary Fiscal Policy (XFP) Flaw: Crowding Out</h4>
                    <p>When the government increases spending or cuts taxes (XFP), it must borrow money, increasing the demand for loanable funds (<b>DLF</b> shifts right). This drives the Real Interest Rate (<b>r</b>) up. This higher <b>r</b> makes borrowing more expensive for private firms, which discourages private investment (<b>I</b>). This phenomenon, known as **Crowding Out**, limits the policy's effectiveness in boosting <b>AD</b> and, critically, slows the growth of the economy's productive capacity (<b>LRAS</b>) in the long run.</p>
                </div>

                <!-- CFP Flaw: Implementation Lag -->
                <div class="p-4 border border-red-300 rounded-lg bg-red-50">
                    <h4 class="font-bold text-red-700 mb-1">Contractionary Fiscal Policy (CFP) Flaw: Implementation Lag</h4>
                    <p>CFP (reduced spending or raised taxes) requires political consensus and legislation. This process is inherently slow, creating a significant **implementation lag**. By the time the policy takes effect (often 12-18 months later), the initial economic problem (e.g., inflation) may have worsened or even been replaced by a recession, causing the policy to become destabilizing or procyclical.</p>
                </div>

                <!-- XMP Flaw: Impact Lag -->
                <div class="p-4 border border-red-300 rounded-lg bg-red-50">
                    <h4 class="font-bold text-red-700 mb-1">Expansionary Monetary Policy (XMP) Flaw: Long and Variable Impact Lag</h4>
                    <p>Monetary policy (like lowering the Federal Funds Rate) affects the economy through a slow, indirect process: bank reserves &rarr; interest rates &rarr; consumption/investment decisions. The total effect of XMP on <b>AD</b> takes a long time, leading to a **long and variable impact lag** (often 6-18 months). This variability makes it hard for the central bank to time its interventions precisely, risking overshooting or undershooting its inflation and growth targets.</p>
                </div>

                <!-- CMP Flaw: Long-Run Growth Slowdown -->
                <div class="p-4 border border-red-300 rounded-lg bg-red-50">
                    <h4 class="font-bold text-red-700 mb-1">Contractionary Monetary Policy (CMP) Flaw: Long-Run Growth Slowdown</h4>
                    <p>While effective at fighting inflation, CMP (raising interest rates) deliberately increases the cost of capital. This results in lower private investment (<b>I</b>), which reduces the accumulation of physical capital (factories, equipment). In the long run, slower investment growth means the economy's potential output (<b>LRAS</b>) grows more slowly, sacrificing future economic prosperity for present price stability.</p>
                </div>

                <h3 class="xl font-semibold text-indigo-700 mb-4 border-b pb-1 mt-6">Successful Policy Combinations</h3>

                <!-- Combined Policy Success -->
                <div class="p-4 border border-green-300 rounded-lg bg-green-50">
                    <h4 class="font-bold text-green-700 mb-1">Success of Coordinated Policy (Obama & Truman)</h4>
                    <p>Coordinated combinations eliminate the primary flaw of each standalone policy. During recessions, the **Obama Combination** (<b>XFP</b> + <b>XMP</b>) uses XMP (<b>SLF</b> right) to offset the upward pressure on the Real Interest Rate (<b>r</b>) caused by XFP (<b>DLF</b> right). This prevents Crowding Out, allowing investment (<b>I</b>) to remain high while maximizing <b>AD</b> stimulus. Conversely, during periods of high inflation, the **Truman Combination** (<b>CFP</b> + <b>CMP</b>) works together to contract <b>AD</b>, with CFP (<b>DLF</b> left) preventing a disruptive spike in investment that would counteract CMP (<b>SLF</b> left), ensuring a smooth return to price stability.</p>
                </div>

            </div>
        </section>

    </div>

    <script>
        // --- Configuration and State ---
        const canvasSize = { width: 450, height: 400 };
        const PLOT_AREA = { x: 50, y: 30, w: 350, h: 320 }; // Plot area dimensions
        const SCALE_FACTOR = 0.05; // Sensitivity of shifts to slider value

        let fiscalValue = 0;
        let monetaryValue = 0;

        const mlfCanvas = document.getElementById('mlfCanvas');
        const asadCanvas = document.getElementById('asadCanvas');
        const mlfCtx = mlfCanvas.getContext('2d');
        const asadCtx = asadCanvas.getContext('2d');

        // Set initial canvas dimensions
        mlfCanvas.width = canvasSize.width;
        mlfCanvas.height = canvasSize.height;
        asadCanvas.width = canvasSize.width;
        asadCanvas.height = canvasSize.height;


        // --- Utility Functions for Drawing ---

        // Draws an axis with labels
        function drawAxis(ctx, title, xLabel, yLabel) {
            ctx.clearRect(0, 0, canvasSize.width, canvasSize.height);
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;

            // X-axis (Horizontal)
            ctx.beginPath();
            ctx.moveTo(PLOT_AREA.x, PLOT_AREA.y + PLOT_AREA.h);
            ctx.lineTo(PLOT_AREA.x + PLOT_AREA.w, PLOT_AREA.y + PLOT_AREA.h);
            ctx.stroke();

            // Y-axis (Vertical)
            ctx.beginPath();
            ctx.moveTo(PLOT_AREA.x, PLOT_AREA.y + PLOT_AREA.h);
            ctx.lineTo(PLOT_AREA.x, PLOT_AREA.y);
            ctx.stroke();

            // Labels
            ctx.fillStyle = '#333';
            ctx.font = '14px Inter';

            // Y-axis Label
            ctx.save();
            ctx.translate(PLOT_AREA.x - 30, PLOT_AREA.y + PLOT_AREA.h / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.textAlign = 'center';
            ctx.fillText(yLabel, 0, 0);
            ctx.restore();

            // X-axis Label
            ctx.textAlign = 'center';
            ctx.fillText(xLabel, PLOT_AREA.x + PLOT_AREA.w / 2, PLOT_AREA.y + PLOT_AREA.h + 20);

            // Title
            ctx.font = '16px Inter';
            ctx.fillText(title, PLOT_AREA.x + PLOT_AREA.w / 2, 20);
        }

        // Draws a line given a function f(x), where y = f(x)
        function drawCurve(ctx, curveFn, color, isDashed = false, label = '', yOffset = 0) {
            ctx.strokeStyle = color;
            ctx.lineWidth = 3;
            ctx.setLineDash(isDashed ? [5, 5] : []);

            ctx.beginPath();

            let firstPoint = true;
            for (let x = 0; x <= PLOT_AREA.w; x += 1) {
                const y = curveFn(x) + yOffset;
                const canvasX = PLOT_AREA.x + x;
                const canvasY = PLOT_AREA.y + PLOT_AREA.h - y;

                if (firstPoint) {
                    ctx.moveTo(canvasX, canvasY);
                    firstPoint = false;
                } else {
                    ctx.lineTo(canvasX, canvasY);
                }
            }
            ctx.stroke();
            ctx.setLineDash([]); // Reset dashed state

            // Draw label at the top right end of the curve
            const finalX = PLOT_AREA.x + PLOT_AREA.w + 10;
            const finalY = PLOT_AREA.y + PLOT_AREA.h - (curveFn(PLOT_AREA.w) + yOffset);
            ctx.fillStyle = color;
            ctx.font = '14px Inter';
            ctx.textAlign = 'left';
            ctx.fillText(label, finalX, finalY + 5);
        }

        // Draws an equilibrium point
        function drawEquilibrium(ctx, x, y, label) {
            const canvasX = PLOT_AREA.x + x;
            const canvasY = PLOT_AREA.y + PLOT_AREA.h - y;

            ctx.fillStyle = '#059669'; // Emerald green
            ctx.beginPath();
            ctx.arc(canvasX, canvasY, 4, 0, Math.PI * 2);
            ctx.fill();

            ctx.font = '14px Inter';
            ctx.textAlign = 'left';
            ctx.fillText(label, canvasX + 8, canvasY + 5);
        }


        // --- MLF Graph Drawing Logic ---

        function drawMLF(shiftD, shiftS) {
            drawAxis(mlfCtx, 'Loanable Funds Market', 'QLF', 'Real Interest Rate (r)');

            // Base Curve Definitions (Linear for simplicity)
            // DLF (Demand): Decreasing function (steeper)
            const dlfFn = (x) => 0.5 * PLOT_AREA.h - 0.5 * x;
            // SLF (Supply): Increasing function (less steep)
            const slfFn = (x) => 0.1 * PLOT_AREA.h + 0.5 * x;

            // E0 (Initial Equilibrium - No Shift)
            // Set x0 at 50% of PLOT_AREA.w, y0 at 50% of PLOT_AREA.h
            const x0 = PLOT_AREA.w / 2;
            const y0 = dlfFn(x0);
            drawEquilibrium(mlfCtx, x0, y0, 'E₀');

            // Draw initial curves
            drawCurve(mlfCtx, dlfFn, '#3B82F6', false, 'DLF₀'); // Blue
            drawCurve(mlfCtx, slfFn, '#F59E0B', false, 'SLF₀'); // Amber

            // Calculate Shifted Curves
            const shiftDx = fiscalValue * SCALE_FACTOR * PLOT_AREA.w; // D_LF shift (XFP increases DLF, CFP decreases DLF)
            const shiftSx = monetaryValue * SCALE_FACTOR * PLOT_AREA.w; // S_LF shift (XMP increases SLF, CMP decreases SLF)

            const dlfShiftedFn = (x) => dlfFn(x - shiftDx);
            const slfShiftedFn = (x) => slfFn(x - shiftSx);

            // Find E1 (New Equilibrium) by solving the shifted functions
            // Set dlfShiftedFn(x1) = slfShiftedFn(x1)
            // 0.5*H - 0.5*(x1 - shiftDx) = 0.1*H + 0.5*(x1 - shiftSx)
            // 0.4*H + 0.5*shiftDx + 0.5*shiftSx = x1
            const x1 = 0.4 * PLOT_AREA.h + 0.5 * shiftDx + 0.5 * shiftSx; 
            const y1 = dlfShiftedFn(x1); // or slfShiftedFn(x1)

            // Draw shifted curves if necessary
            if (shiftDx !== 0) {
                drawCurve(mlfCtx, dlfShiftedFn, '#3B82F6', true, 'DLF₁'); // Dashed Blue
            }
            if (shiftSx !== 0) {
                drawCurve(mlfCtx, slfShiftedFn, '#F59E0B', true, 'SLF₁'); // Dashed Amber
            }

            // Draw new equilibrium point
            if (shiftDx !== 0 || shiftSx !== 0) {
                drawEquilibrium(mlfCtx, x1, y1, 'E₁');
            }
        }


        // --- AS-AD Graph Drawing Logic ---

        function drawASAD(shiftAD) {
            drawAxis(asadCtx, 'Aggregate Supply-Demand', 'Real GDP (rgdp)', 'Price Level (PL)');

            // LRAS (Long-Run Aggregate Supply) - Vertical at Potential Output (Yp)
            const yP = PLOT_AREA.w / 2;
            asadCtx.strokeStyle = '#9CA3AF'; // Gray
            asadCtx.lineWidth = 2;
            asadCtx.setLineDash([2, 4]);
            asadCtx.beginPath();
            asadCtx.moveTo(PLOT_AREA.x + yP, PLOT_AREA.y + PLOT_AREA.h);
            asadCtx.lineTo(PLOT_AREA.x + yP, PLOT_AREA.y);
            asadCtx.stroke();
            asadCtx.setLineDash([]);
            asadCtx.fillStyle = '#9CA3AF';
            asadCtx.font = '14px Inter';
            asadCtx.textAlign = 'center';
            asadCtx.fillText('LRAS (Yp)', PLOT_AREA.x + yP + 30, PLOT_AREA.y + PLOT_AREA.h - 10);

            // SRAS (Short-Run Aggregate Supply) - Upward sloping
            const srasFn = (x) => 0.1 * PLOT_AREA.h + 0.7 * x;
            drawCurve(asadCtx, srasFn, '#10B981', false, 'SRAS'); // Green

            // AD (Aggregate Demand) - Downward sloping
            const adFn = (x) => 0.9 * PLOT_AREA.h - 0.7 * x;

            // E0 (Initial Equilibrium)
            const adFn_original = (x) => adFn(x);
            const x0 = PLOT_AREA.w / 2;
            const y0 = srasFn(x0);
            drawEquilibrium(asadCtx, x0, y0, 'E₀');
            drawCurve(asadCtx, adFn_original, '#3B82F6', false, 'AD₀'); // Blue

            // Calculate Shifted AD Curve
            const adShiftedFn = (x) => adFn(x - shiftAD);

            // Find E1 (New Equilibrium) by solving the shifted AD with SRAS:
            // adShiftedFn(x1) = srasFn(x1)
            // 0.9*H - 0.7*(x1 - shiftAD) = 0.1*H + 0.7*x1
            // 0.8*H + 0.7*shiftAD = 1.4*x1
            // x1 = (0.8*H + 0.7*shiftAD) / 1.4
            const x1 = (0.8 * PLOT_AREA.h + 0.7 * shiftAD) / 1.4;
            const y1 = srasFn(x1);

            // Draw shifted AD curve if necessary
            if (shiftAD !== 0) {
                drawCurve(asadCtx, adShiftedFn, '#3B82F6', true, 'AD₁'); // Dashed Blue
                drawEquilibrium(asadCtx, x1, y1, 'E₁');
            }
        }


        // --- Policy Update Logic (Updated to remove analysis call) ---

        function updatePolicy(type, value) {
            const val = parseInt(value);

            if (type === 'fiscal') {
                fiscalValue = val;
                const textElement = document.getElementById('fiscalValueText');
                if (val > 0) {
                    textElement.textContent = `Expansionary (XFP: +${val})`;
                    textElement.className = 'font-bold text-green-600';
                } else if (val < 0) {
                    textElement.textContent = `Contractionary (CFP: ${val})`;
                    textElement.className = 'font-bold text-red-600';
                } else {
                    textElement.textContent = 'Neutral';
                    textElement.className = 'font-bold text-red-500';
                }
            } else if (type === 'monetary') {
                monetaryValue = val;
                const textElement = document.getElementById('monetaryValueText');
                if (val > 0) {
                    textElement.textContent = `Expansionary (XMP: +${val})`;
                    textElement.className = 'font-bold text-green-600';
                } else if (val < 0) {
                    textElement.textContent = `Contractionary (CMP: ${val})`;
                    textElement.className = 'font-bold text-red-600';
                } else {
                    textElement.textContent = 'Neutral';
                    textElement.className = 'font-bold text-red-500';
                }
            }

            // Calculate Shifts
            const fiscalShiftDLF = fiscalValue * SCALE_FACTOR * PLOT_AREA.w; // D_LF shift
            const monetaryShiftSLF = monetaryValue * SCALE_FACTOR * PLOT_AREA.w; // S_LF shift
            const combinedADShift = (fiscalValue + monetaryValue) * SCALE_FACTOR * PLOT_AREA.w * 0.8; // AD shift

            // Redraw Graphs
            drawMLF(fiscalShiftDLF, monetaryShiftSLF);
            drawASAD(combinedADShift);

            // Removed: updateAnalysis(fiscalValue, monetaryValue);
        }

        // --- Initialization ---
        window.onload = () => {
            // Draw initial (neutral) state
            updatePolicy('fiscal', 0);
            updatePolicy('monetary', 0);
        };
    </script>
</body>
</html>
